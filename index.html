<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Verification & Payment</title>
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” Card Verification & Payment</h1>
            <p>Secure card verification and real transaction processing</p>
            <div style="margin-top: 15px;">
                <a href="dashboard.html" style="display: inline-block; padding: 10px 20px; background: #4285f4; color: white; text-decoration: none; border-radius: 8px; font-weight: 500; transition: background 0.3s ease;">
                    ğŸ“Š View Transaction Dashboard
                </a>
            </div>
        </div>

        <div class="form-container">
            <div class="mode-selector">
                <div class="mode-toggle">
                    <input type="radio" id="auth-mode" name="operation_mode" value="authentication" checked>
                    <label for="auth-mode">
                        <strong>ğŸ” Card Validation</strong>
                        <small>Verification without charges</small>
                    </label>
                    
                    <input type="radio" id="payment-mode" name="operation_mode" value="payment">
                    <label for="payment-mode">
                        <strong>ğŸ’³ Real Payment Testing</strong>
                        <small>Process actual sandbox transactions</small>
                    </label>
                </div>
            </div>

            <div class="info-panel" id="auth-info-panel">
                <h4>ğŸ“‹ What is Card Verification?</h4>
                <ul>
                    <li><strong>Basic:</strong> Validates card number and expiration</li>
                    <li><strong>AVS:</strong> Verifies billing address matches card</li>
                    <li><strong>CVV:</strong> Confirms security code on card</li>
                    <li><strong>Full:</strong> Complete verification with all checks</li>
                </ul>
            </div>

            <div class="info-panel" id="payment-info-panel" style="display: none;">
                <h4>ğŸ’³ Real Payment Processing</h4>
                <ul>
                    <li><strong>Secure:</strong> PCI-compliant hosted payment page</li>
                    <li><strong>Real Charges:</strong> Actual transaction processing</li>
                    <li><strong>Test Cards:</strong> Use Global Payments test cards</li>
                    <li><strong>Dashboard:</strong> View real transaction results</li>
                </ul>
            </div>

            <form id="verification-form">
                <div class="verification-type-selector">
                    <label>Choose Verification Type:</label>
                    <div class="verification-options">
                        <div class="verification-option">
                            <input type="radio" id="basic" name="verification_type" value="basic" checked>
                            <label for="basic">
                                <strong>Basic</strong>
                                <small>Card validation only</small>
                            </label>
                        </div>
                        <div class="verification-option">
                            <input type="radio" id="avs" name="verification_type" value="avs">
                            <label for="avs">
                                <strong>AVS Check</strong>
                                <small>Address verification</small>
                            </label>
                        </div>
                        <div class="verification-option">
                            <input type="radio" id="cvv" name="verification_type" value="cvv">
                            <label for="cvv">
                                <strong>CVV Check</strong>
                                <small>Security code validation</small>
                            </label>
                        </div>
                        <div class="verification-option">
                            <input type="radio" id="full" name="verification_type" value="full">
                            <label for="full">
                                <strong>Full Verification</strong>
                                <small>All checks combined</small>
                            </label>
                        </div>
                    </div>
                </div>

                <div id="credit-card"></div>

                <div id="optional-sections" class="optional-sections">
                    <div class="form-section" id="billing-section">
                        <h3>ğŸ“ Billing Address (for AVS)</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="street">Street Address</label>
                                <input type="text" id="street" name="street" placeholder="123 Main St">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="city">City</label>
                                <input type="text" id="city" name="city" placeholder="New York">
                            </div>
                            <div class="form-group">
                                <label for="state">State</label>
                                <input type="text" id="state" name="state" placeholder="NY" maxlength="2">
                            </div>
                            <div class="form-group">
                                <label for="postal_code">ZIP Code</label>
                                <input type="text" id="postal_code" name="postal_code" placeholder="12345">
                            </div>
                        </div>
                    </div>

                    <div class="form-section" id="customer-section">
                        <h3>ğŸ‘¤ Customer Information (Optional)</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="customer_id">Customer ID</label>
                                <input type="text" id="customer_id" name="customer_id" placeholder="CUST_12345">
                            </div>
                            <div class="form-group">
                                <label for="email">Email</label>
                                <input type="email" id="email" name="email" placeholder="customer@example.com">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="phone">Phone</label>
                                <input type="tel" id="phone" name="phone" placeholder="(555) 123-4567">
                            </div>
                        </div>
                    </div>
                </div>
            </form>

            <!-- Payment Form for HPP Integration -->
            <div id="payment-form" style="display: none;">
                <div class="form-section">
                    <h3>ğŸ’³ Payment Details</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="payment-amount">Amount (USD)</label>
                            <input type="number" id="payment-amount" name="payment-amount" placeholder="10.00" min="0.01" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="payment-currency">Currency</label>
                            <select id="payment-currency" name="payment-currency">
                                <option value="USD" selected>USD - US Dollar</option>
                                <option value="EUR">EUR - Euro</option>
                                <option value="GBP">GBP - British Pound</option>
                                <option value="CAD">CAD - Canadian Dollar</option>
                                <option value="AUD">AUD - Australian Dollar</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>ğŸ‘¤ Customer Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="payment-customer-first-name">First Name</label>
                            <input type="text" id="payment-customer-first-name" name="payment-customer-first-name" placeholder="John">
                        </div>
                        <div class="form-group">
                            <label for="payment-customer-last-name">Last Name</label>
                            <input type="text" id="payment-customer-last-name" name="payment-customer-last-name" placeholder="Doe">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="payment-customer-email">Email</label>
                            <input type="email" id="payment-customer-email" name="payment-customer-email" placeholder="john.doe@example.com">
                        </div>
                        <div class="form-group">
                            <label for="payment-customer-phone">Phone</label>
                            <input type="tel" id="payment-customer-phone" name="payment-customer-phone" placeholder="(555) 123-4567">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>ğŸ“ Billing Address (Optional)</h3>
                    
                    <!-- Country Selection - First Priority -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="payment-billing-country">Country</label>
                            <select id="payment-billing-country" name="payment-billing-country" class="country-select">
                                <option value="">Select Country</option>
                                
                                <!-- Major English-speaking Countries -->
                                <option value="US" selected>ğŸ‡ºğŸ‡¸ United States</option>
                                <option value="CA">ğŸ‡¨ğŸ‡¦ Canada</option>
                                <option value="GB">ğŸ‡¬ğŸ‡§ United Kingdom</option>
                                <option value="AU">ğŸ‡¦ğŸ‡º Australia</option>
                                <option value="IE">ğŸ‡®ğŸ‡ª Ireland</option>
                                <option value="NZ">ğŸ‡³ğŸ‡¿ New Zealand</option>
                                <option value="ZA">ğŸ‡¿ğŸ‡¦ South Africa</option>
                                
                                <!-- Major European Countries -->
                                <option value="DE">ğŸ‡©ğŸ‡ª Germany</option>
                                <option value="FR">ğŸ‡«ğŸ‡· France</option>
                                <option value="IT">ğŸ‡®ğŸ‡¹ Italy</option>
                                <option value="ES">ğŸ‡ªğŸ‡¸ Spain</option>
                                <option value="NL">ğŸ‡³ğŸ‡± Netherlands</option>
                                <option value="CH">ğŸ‡¨ğŸ‡­ Switzerland</option>
                                <option value="AT">ğŸ‡¦ğŸ‡¹ Austria</option>
                                <option value="BE">ğŸ‡§ğŸ‡ª Belgium</option>
                                <option value="SE">ğŸ‡¸ğŸ‡ª Sweden</option>
                                <option value="NO">ğŸ‡³ğŸ‡´ Norway</option>
                                <option value="DK">ğŸ‡©ğŸ‡° Denmark</option>
                                <option value="FI">ğŸ‡«ğŸ‡® Finland</option>
                                <option value="PL">ğŸ‡µğŸ‡± Poland</option>
                                <option value="PT">ğŸ‡µğŸ‡¹ Portugal</option>
                                <option value="GR">ğŸ‡¬ğŸ‡· Greece</option>
                                <option value="CZ">ğŸ‡¨ğŸ‡¿ Czech Republic</option>
                                <option value="HU">ğŸ‡­ğŸ‡º Hungary</option>
                                <option value="RO">ğŸ‡·ğŸ‡´ Romania</option>
                                <option value="BG">ğŸ‡§ğŸ‡¬ Bulgaria</option>
                                <option value="HR">ğŸ‡­ğŸ‡· Croatia</option>
                                <option value="SI">ğŸ‡¸ğŸ‡® Slovenia</option>
                                <option value="SK">ğŸ‡¸ğŸ‡° Slovakia</option>
                                <option value="EE">ğŸ‡ªğŸ‡ª Estonia</option>
                                <option value="LV">ğŸ‡±ğŸ‡» Latvia</option>
                                <option value="LT">ğŸ‡±ğŸ‡¹ Lithuania</option>
                                <option value="CY">ğŸ‡¨ğŸ‡¾ Cyprus</option>
                                <option value="MT">ğŸ‡²ğŸ‡¹ Malta</option>
                                <option value="LU">ğŸ‡±ğŸ‡º Luxembourg</option>
                                <option value="IS">ğŸ‡®ğŸ‡¸ Iceland</option>
                                <option value="LI">ğŸ‡±ğŸ‡® Liechtenstein</option>
                                <option value="MC">ğŸ‡²ğŸ‡¨ Monaco</option>
                                <option value="AD">ğŸ‡¦ğŸ‡© Andorra</option>
                                <option value="SM">ğŸ‡¸ğŸ‡² San Marino</option>
                                <option value="VA">ğŸ‡»ğŸ‡¦ Vatican City</option>
                                
                                <!-- Asia-Pacific -->
                                <option value="JP">ğŸ‡¯ğŸ‡µ Japan</option>
                                <option value="CN">ğŸ‡¨ğŸ‡³ China</option>
                                <option value="KR">ğŸ‡°ğŸ‡· South Korea</option>
                                <option value="IN">ğŸ‡®ğŸ‡³ India</option>
                                <option value="SG">ğŸ‡¸ğŸ‡¬ Singapore</option>
                                <option value="HK">ğŸ‡­ğŸ‡° Hong Kong</option>
                                <option value="TW">ğŸ‡¹ğŸ‡¼ Taiwan</option>
                                <option value="MY">ğŸ‡²ğŸ‡¾ Malaysia</option>
                                <option value="TH">ğŸ‡¹ğŸ‡­ Thailand</option>
                                <option value="ID">ğŸ‡®ğŸ‡© Indonesia</option>
                                <option value="PH">ğŸ‡µğŸ‡­ Philippines</option>
                                <option value="VN">ğŸ‡»ğŸ‡³ Vietnam</option>
                                <option value="PK">ğŸ‡µğŸ‡° Pakistan</option>
                                <option value="BD">ğŸ‡§ğŸ‡© Bangladesh</option>
                                <option value="LK">ğŸ‡±ğŸ‡° Sri Lanka</option>
                                <option value="NP">ğŸ‡³ğŸ‡µ Nepal</option>
                                <option value="MM">ğŸ‡²ğŸ‡² Myanmar</option>
                                <option value="KH">ğŸ‡°ğŸ‡­ Cambodia</option>
                                <option value="LA">ğŸ‡±ğŸ‡¦ Laos</option>
                                <option value="BN">ğŸ‡§ğŸ‡³ Brunei</option>
                                <option value="MN">ğŸ‡²ğŸ‡³ Mongolia</option>
                                
                                <!-- Americas -->
                                <option value="MX">ğŸ‡²ğŸ‡½ Mexico</option>
                                <option value="BR">ğŸ‡§ğŸ‡· Brazil</option>
                                <option value="AR">ğŸ‡¦ğŸ‡· Argentina</option>
                                <option value="CL">ğŸ‡¨ğŸ‡± Chile</option>
                                <option value="CO">ğŸ‡¨ğŸ‡´ Colombia</option>
                                <option value="PE">ğŸ‡µğŸ‡ª Peru</option>
                                <option value="VE">ğŸ‡»ğŸ‡ª Venezuela</option>
                                <option value="EC">ğŸ‡ªğŸ‡¨ Ecuador</option>
                                <option value="BO">ğŸ‡§ğŸ‡´ Bolivia</option>
                                <option value="PY">ğŸ‡µğŸ‡¾ Paraguay</option>
                                <option value="UY">ğŸ‡ºğŸ‡¾ Uruguay</option>
                                <option value="GY">ğŸ‡¬ğŸ‡¾ Guyana</option>
                                <option value="SR">ğŸ‡¸ğŸ‡· Suriname</option>
                                <option value="GT">ğŸ‡¬ğŸ‡¹ Guatemala</option>
                                <option value="HN">ğŸ‡­ğŸ‡³ Honduras</option>
                                <option value="SV">ğŸ‡¸ğŸ‡» El Salvador</option>
                                <option value="NI">ğŸ‡³ğŸ‡® Nicaragua</option>
                                <option value="CR">ğŸ‡¨ğŸ‡· Costa Rica</option>
                                <option value="PA">ğŸ‡µğŸ‡¦ Panama</option>
                                <option value="BZ">ğŸ‡§ğŸ‡¿ Belize</option>
                                <option value="JM">ğŸ‡¯ğŸ‡² Jamaica</option>
                                <option value="CU">ğŸ‡¨ğŸ‡º Cuba</option>
                                <option value="DO">ğŸ‡©ğŸ‡´ Dominican Republic</option>
                                <option value="HT">ğŸ‡­ğŸ‡¹ Haiti</option>
                                <option value="TT">ğŸ‡¹ğŸ‡¹ Trinidad and Tobago</option>
                                <option value="BB">ğŸ‡§ğŸ‡§ Barbados</option>
                                <option value="BS">ğŸ‡§ğŸ‡¸ Bahamas</option>
                                
                                <!-- Middle East -->
                                <option value="AE">ğŸ‡¦ğŸ‡ª United Arab Emirates</option>
                                <option value="SA">ğŸ‡¸ğŸ‡¦ Saudi Arabia</option>
                                <option value="IL">ğŸ‡®ğŸ‡± Israel</option>
                                <option value="TR">ğŸ‡¹ğŸ‡· Turkey</option>
                                <option value="IR">ğŸ‡®ğŸ‡· Iran</option>
                                <option value="IQ">ğŸ‡®ğŸ‡¶ Iraq</option>
                                <option value="JO">ğŸ‡¯ğŸ‡´ Jordan</option>
                                <option value="LB">ğŸ‡±ğŸ‡§ Lebanon</option>
                                <option value="SY">ğŸ‡¸ğŸ‡¾ Syria</option>
                                <option value="YE">ğŸ‡¾ğŸ‡ª Yemen</option>
                                <option value="OM">ğŸ‡´ğŸ‡² Oman</option>
                                <option value="QA">ğŸ‡¶ğŸ‡¦ Qatar</option>
                                <option value="BH">ğŸ‡§ğŸ‡­ Bahrain</option>
                                <option value="KW">ğŸ‡°ğŸ‡¼ Kuwait</option>
                                <option value="PS">ğŸ‡µğŸ‡¸ Palestine</option>
                                <option value="AF">ğŸ‡¦ğŸ‡« Afghanistan</option>
                                
                                <!-- Africa -->
                                <option value="NG">ğŸ‡³ğŸ‡¬ Nigeria</option>
                                <option value="EG">ğŸ‡ªğŸ‡¬ Egypt</option>
                                <option value="ET">ğŸ‡ªğŸ‡¹ Ethiopia</option>
                                <option value="KE">ğŸ‡°ğŸ‡ª Kenya</option>
                                <option value="UG">ğŸ‡ºğŸ‡¬ Uganda</option>
                                <option value="TZ">ğŸ‡¹ğŸ‡¿ Tanzania</option>
                                <option value="GH">ğŸ‡¬ğŸ‡­ Ghana</option>
                                <option value="MZ">ğŸ‡²ğŸ‡¿ Mozambique</option>
                                <option value="MG">ğŸ‡²ğŸ‡¬ Madagascar</option>
                                <option value="AO">ğŸ‡¦ğŸ‡´ Angola</option>
                                <option value="CM">ğŸ‡¨ğŸ‡² Cameroon</option>
                                <option value="CI">ğŸ‡¨ğŸ‡® Ivory Coast</option>
                                <option value="NE">ğŸ‡³ğŸ‡ª Niger</option>
                                <option value="BF">ğŸ‡§ğŸ‡« Burkina Faso</option>
                                <option value="ML">ğŸ‡²ğŸ‡± Mali</option>
                                <option value="MW">ğŸ‡²ğŸ‡¼ Malawi</option>
                                <option value="ZM">ğŸ‡¿ğŸ‡² Zambia</option>
                                <option value="SN">ğŸ‡¸ğŸ‡³ Senegal</option>
                                <option value="SO">ğŸ‡¸ğŸ‡´ Somalia</option>
                                <option value="TD">ğŸ‡¹ğŸ‡© Chad</option>
                                <option value="ZW">ğŸ‡¿ğŸ‡¼ Zimbabwe</option>
                                <option value="BW">ğŸ‡§ğŸ‡¼ Botswana</option>
                                <option value="NA">ğŸ‡³ğŸ‡¦ Namibia</option>
                                <option value="LS">ğŸ‡±ğŸ‡¸ Lesotho</option>
                                <option value="SZ">ğŸ‡¸ğŸ‡¿ Eswatini</option>
                                <option value="GA">ğŸ‡¬ğŸ‡¦ Gabon</option>
                                <option value="GQ">ğŸ‡¬ğŸ‡¶ Equatorial Guinea</option>
                                <option value="CG">ğŸ‡¨ğŸ‡¬ Republic of the Congo</option>
                                <option value="CD">ğŸ‡¨ğŸ‡© Democratic Republic of the Congo</option>
                                <option value="CF">ğŸ‡¨ğŸ‡« Central African Republic</option>
                                <option value="ST">ğŸ‡¸ğŸ‡¹ SÃ£o TomÃ© and PrÃ­ncipe</option>
                                <option value="DJ">ğŸ‡©ğŸ‡¯ Djibouti</option>
                                <option value="ER">ğŸ‡ªğŸ‡· Eritrea</option>
                                <option value="GM">ğŸ‡¬ğŸ‡² Gambia</option>
                                <option value="GN">ğŸ‡¬ğŸ‡³ Guinea</option>
                                <option value="GW">ğŸ‡¬ğŸ‡¼ Guinea-Bissau</option>
                                <option value="LR">ğŸ‡±ğŸ‡· Liberia</option>
                                <option value="SL">ğŸ‡¸ğŸ‡± Sierra Leone</option>
                                <option value="TG">ğŸ‡¹ğŸ‡¬ Togo</option>
                                <option value="BJ">ğŸ‡§ğŸ‡¯ Benin</option>
                                <option value="RW">ğŸ‡·ğŸ‡¼ Rwanda</option>
                                <option value="BI">ğŸ‡§ğŸ‡® Burundi</option>
                                <option value="KM">ğŸ‡°ğŸ‡² Comoros</option>
                                <option value="MU">ğŸ‡²ğŸ‡º Mauritius</option>
                                <option value="SC">ğŸ‡¸ğŸ‡¨ Seychelles</option>
                                <option value="CV">ğŸ‡¨ğŸ‡» Cape Verde</option>
                                <option value="MR">ğŸ‡²ğŸ‡· Mauritania</option>
                                <option value="MA">ğŸ‡²ğŸ‡¦ Morocco</option>
                                <option value="DZ">ğŸ‡©ğŸ‡¿ Algeria</option>
                                <option value="TN">ğŸ‡¹ğŸ‡³ Tunisia</option>
                                <option value="LY">ğŸ‡±ğŸ‡¾ Libya</option>
                                <option value="SD">ğŸ‡¸ğŸ‡© Sudan</option>
                                <option value="SS">ğŸ‡¸ğŸ‡¸ South Sudan</option>
                                
                                <!-- Eastern Europe & Russia -->
                                <option value="RU">ğŸ‡·ğŸ‡º Russia</option>
                                <option value="UA">ğŸ‡ºğŸ‡¦ Ukraine</option>
                                <option value="BY">ğŸ‡§ğŸ‡¾ Belarus</option>
                                <option value="MD">ğŸ‡²ğŸ‡© Moldova</option>
                                <option value="GE">ğŸ‡¬ğŸ‡ª Georgia</option>
                                <option value="AM">ğŸ‡¦ğŸ‡² Armenia</option>
                                <option value="AZ">ğŸ‡¦ğŸ‡¿ Azerbaijan</option>
                                <option value="KZ">ğŸ‡°ğŸ‡¿ Kazakhstan</option>
                                <option value="KG">ğŸ‡°ğŸ‡¬ Kyrgyzstan</option>
                                <option value="TJ">ğŸ‡¹ğŸ‡¯ Tajikistan</option>
                                <option value="TM">ğŸ‡¹ğŸ‡² Turkmenistan</option>
                                <option value="UZ">ğŸ‡ºğŸ‡¿ Uzbekistan</option>
                                <option value="RS">ğŸ‡·ğŸ‡¸ Serbia</option>
                                <option value="ME">ğŸ‡²ğŸ‡ª Montenegro</option>
                                <option value="BA">ğŸ‡§ğŸ‡¦ Bosnia and Herzegovina</option>
                                <option value="MK">ğŸ‡²ğŸ‡° North Macedonia</option>
                                <option value="AL">ğŸ‡¦ğŸ‡± Albania</option>
                                <option value="XK">ğŸ‡½ğŸ‡° Kosovo</option>
                                
                                <!-- Oceania -->
                                <option value="FJ">ğŸ‡«ğŸ‡¯ Fiji</option>
                                <option value="PG">ğŸ‡µğŸ‡¬ Papua New Guinea</option>
                                <option value="SB">ğŸ‡¸ğŸ‡§ Solomon Islands</option>
                                <option value="VU">ğŸ‡»ğŸ‡º Vanuatu</option>
                                <option value="NC">ğŸ‡³ğŸ‡¨ New Caledonia</option>
                                <option value="PF">ğŸ‡µğŸ‡« French Polynesia</option>
                                <option value="WS">ğŸ‡¼ğŸ‡¸ Samoa</option>
                                <option value="TO">ğŸ‡¹ğŸ‡´ Tonga</option>
                                <option value="KI">ğŸ‡°ğŸ‡® Kiribati</option>
                                <option value="TV">ğŸ‡¹ğŸ‡» Tuvalu</option>
                                <option value="NR">ğŸ‡³ğŸ‡· Nauru</option>
                                <option value="PW">ğŸ‡µğŸ‡¼ Palau</option>
                                <option value="MH">ğŸ‡²ğŸ‡­ Marshall Islands</option>
                                <option value="FM">ğŸ‡«ğŸ‡² Micronesia</option>
                            </select>
                        </div>
                    </div>

                    <!-- Street Address -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="payment-billing-street" id="street-label">Street Address</label>
                            <input type="text" id="payment-billing-street" name="payment-billing-street" 
                                   placeholder="123 Main St" class="address-field">
                        </div>
                    </div>

                    <!-- City, State/Province, Postal Code Row -->
                    <div class="form-row address-row">
                        <div class="form-group">
                            <label for="payment-billing-city" id="city-label">City</label>
                            <input type="text" id="payment-billing-city" name="payment-billing-city" 
                                   placeholder="New York" class="address-field">
                        </div>
                        <div class="form-group">
                            <label for="payment-billing-state" id="state-label">State</label>
                            <input type="text" id="payment-billing-state" name="payment-billing-state" 
                                   placeholder="NY" maxlength="10" class="address-field">
                        </div>
                        <div class="form-group">
                            <label for="payment-billing-postal" id="postal-label">ZIP Code</label>
                            <input type="text" id="payment-billing-postal" name="payment-billing-postal" 
                                   placeholder="12345" class="address-field">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <button type="button" id="start-payment-btn" class="payment-button">
                        ğŸš€ Start Secure Payment
                    </button>
                    <p class="payment-note">
                        Global Payments secure payment form will open in this page
                    </p>
                </div>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Verifying card...</p>
            </div>

            <div class="result-container" id="result-container">
                <div id="result-content"></div>
            </div>
        </div>
    </div>

    <script src="https://js.globalpay.com/v1/globalpayments.js"></script>
    <script>
        class CardAuthenticator {
            constructor() {
                this.cardForm = null;
                this.isInitialized = false;
                this.init();
            }

            async init() {
                try {
                    await this.ensureGlobalPaymentsReady();
                    await this.loadConfiguration();
                    this.setupEventListeners();
                    this.updateFormVisibility();
                    console.log('âœ… Card authenticator initialized');
                } catch (error) {
                    this.showError('Failed to initialize payment form: ' + error.message);
                }
            }

            ensureGlobalPaymentsReady() {
                return new Promise((resolve, reject) => {
                    if (typeof GlobalPayments !== 'undefined') {
                        resolve();
                    } else {
                        let attempts = 0;
                        const checkInterval = setInterval(() => {
                            attempts++;
                            if (typeof GlobalPayments !== 'undefined') {
                                clearInterval(checkInterval);
                                resolve();
                            } else if (attempts >= 20) {
                                clearInterval(checkInterval);
                                reject(new Error('GlobalPayments SDK failed to load'));
                            }
                        }, 250);
                    }
                });
            }

            async loadConfiguration() {
                const response = await fetch('/config.php');
                if (!response.ok) {
                    throw new Error(`Configuration error: ${response.status}`);
                }
                
                const config = await response.json();
                if (!config.success) {
                    throw new Error('Invalid configuration response');
                }

                GlobalPayments.configure({
                    publicApiKey: config.data.publicApiKey
                });

                this.initializeCardForm();
            }

            initializeCardForm() {
                this.cardForm = GlobalPayments.creditCard.form('#verification-form', { 
                    style: "gp-default" 
                });

                this.cardForm.on('token-success', (resp) => {
                    this.handleTokenSuccess(resp);
                });

                this.cardForm.on('token-error', (error) => {
                    this.showError('Card tokenization failed: ' + error.message);
                    this.hideLoading();
                });

                this.isInitialized = true;
            }

            setupEventListeners() {
                // Operation mode change
                document.querySelectorAll('input[name="operation_mode"]').forEach(radio => {
                    radio.addEventListener('change', () => {
                        this.updateOperationMode();
                    });
                });

                // Verification type change
                document.querySelectorAll('input[name="verification_type"]').forEach(radio => {
                    radio.addEventListener('change', () => {
                        this.updateFormVisibility();
                    });
                });

                // Payment button click
                const paymentBtn = document.getElementById('start-payment-btn');
                if (paymentBtn) {
                    paymentBtn.addEventListener('click', () => {
                        this.initiatePayment();
                    });
                }

                // Country selection change
                const countrySelect = document.getElementById('payment-billing-country');
                if (countrySelect) {
                    countrySelect.addEventListener('change', (e) => {
                        this.updateAddressFields(e.target.value);
                    });
                    // Initialize with default country
                    this.updateAddressFields(countrySelect.value);
                }

                // Form submission is handled by the GlobalPayments SDK automatically
                // The token-success event will be triggered when the form is submitted
            }

            updateOperationMode() {
                const operationMode = document.querySelector('input[name="operation_mode"]:checked').value;
                const authInfoPanel = document.getElementById('auth-info-panel');
                const paymentInfoPanel = document.getElementById('payment-info-panel');
                const verificationForm = document.getElementById('verification-form');
                const paymentForm = document.getElementById('payment-form');
                const resultContainer = document.getElementById('result-container');

                if (operationMode === 'authentication') {
                    // Show authentication UI
                    authInfoPanel.style.display = 'block';
                    paymentInfoPanel.style.display = 'none';
                    verificationForm.style.display = 'block';
                    paymentForm.style.display = 'none';
                } else {
                    // Show payment UI
                    authInfoPanel.style.display = 'none';
                    paymentInfoPanel.style.display = 'block';
                    verificationForm.style.display = 'none';
                    paymentForm.style.display = 'block';
                    
                    // Order ID will be automatically generated server-side
                }

                // Hide results when switching modes
                resultContainer.style.display = 'none';
            }

            updateFormVisibility() {
                const verificationType = document.querySelector('input[name="verification_type"]:checked').value;
                const optionalSections = document.getElementById('optional-sections');
                const billingSection = document.getElementById('billing-section');
                const customerSection = document.getElementById('customer-section');

                if (verificationType === 'basic') {
                    optionalSections.classList.remove('show');
                } else {
                    optionalSections.classList.add('show');
                    
                    // Show/hide sections based on verification type
                    billingSection.style.display = (verificationType === 'avs' || verificationType === 'full') ? 'block' : 'none';
                    customerSection.style.display = (verificationType === 'full') ? 'block' : 'none';
                }
            }

            async initiatePayment() {
                try {
                    this.showLoading('Creating secure payment session...');

                    // Collect payment data (Order ID generated automatically server-side)
                    const paymentData = {
                        amount: document.getElementById('payment-amount').value,
                        currency: document.getElementById('payment-currency').value
                    };

                    // Validate required fields
                    if (!paymentData.amount) {
                        throw new Error('Amount is required');
                    }

                    // Add customer data if provided
                    const firstName = document.getElementById('payment-customer-first-name').value;
                    const lastName = document.getElementById('payment-customer-last-name').value;
                    const email = document.getElementById('payment-customer-email').value;
                    const phone = document.getElementById('payment-customer-phone').value;

                    if (firstName || lastName || email || phone) {
                        paymentData.customer = {
                            first_name: firstName,
                            last_name: lastName,
                            email: email,
                            phone: phone
                        };
                    }

                    // Add billing address if provided
                    const street = document.getElementById('payment-billing-street').value;
                    const city = document.getElementById('payment-billing-city').value;
                    const state = document.getElementById('payment-billing-state').value;
                    const postal = document.getElementById('payment-billing-postal').value;
                    const country = document.getElementById('payment-billing-country').value;

                    if (street || city || state || postal || country) {
                        paymentData.billing_address = {
                            street: street,
                            city: city,
                            state: state,
                            postal_code: postal,
                            country: country
                        };
                    }

                    // Create HPP session
                    const response = await fetch('/hpp-create-session.php', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(paymentData)
                    });

                    const result = await response.json();

                    if (result.success) {
                        // Show HPP iframe instead of redirecting
                        this.showHppIframe(result.data.iframe_url, paymentData);
                    } else {
                        throw new Error(result.message || 'Failed to create payment session');
                    }

                } catch (error) {
                    this.showError('Payment initiation failed: ' + error.message);
                } finally {
                    this.hideLoading();
                }
            }

            async handleTokenSuccess(tokenResponse) {
                try {
                    this.showLoading(); // Show loading when we start processing
                    
                    const verificationType = document.querySelector('input[name="verification_type"]:checked').value;
                    
                    const requestData = {
                        payment_token: tokenResponse.paymentReference,
                        verification_type: verificationType
                    };

                    // Add billing address if needed
                    if (verificationType === 'avs' || verificationType === 'full') {
                        requestData.billing_address = {
                            street: document.getElementById('street').value,
                            city: document.getElementById('city').value,
                            state: document.getElementById('state').value,
                            postal_code: document.getElementById('postal_code').value
                        };
                    }

                    // Add customer info if needed
                    if (verificationType === 'full') {
                        requestData.customer = {
                            id: document.getElementById('customer_id').value,
                            email: document.getElementById('email').value,
                            phone: document.getElementById('phone').value
                        };
                    }

                    const response = await fetch('/verify-card.php', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(requestData)
                    });

                    const result = await response.json();
                    
                    if (result.success) {
                        this.showSuccess(result);
                    } else {
                        this.showError(result.message, result);
                    }

                } catch (error) {
                    this.showError('Network error: ' + error.message);
                } finally {
                    this.hideLoading();
                }
            }

            showLoading(message = 'Verifying card...') {
                const loading = document.getElementById('loading');
                const loadingText = loading.querySelector('p');
                loadingText.textContent = message;
                loading.style.display = 'block';
            }

            hideLoading() {
                document.getElementById('loading').style.display = 'none';
            }

            showSuccess(result) {
                const container = document.getElementById('result-container');
                const content = document.getElementById('result-content');
                
                let detailsHtml = '';
                if (result.verification_result) {
                    const vr = result.verification_result;
                    detailsHtml = `
                        <div style="margin-top: 15px; font-size: 0.9em;">
                            <strong>Verification Details:</strong><br>
                            Transaction ID: ${vr.transaction_id}<br>
                            Response: ${vr.response_code} - ${vr.response_message}
                            ${vr.avs_response_code ? `<br>AVS: ${vr.avs_response_code} - ${vr.avs_response_message}` : ''}
                            ${vr.cvn_response_code ? `<br>CVV: ${vr.cvn_response_code} - ${vr.cvn_response_message}` : ''}
                            ${vr.card_type ? `<br>Card Type: ${vr.card_type}` : ''}
                        </div>
                    `;
                }

                content.innerHTML = `
                    <h3>âœ… ${result.message}</h3>
                    <p>Card verification completed successfully!</p>
                    ${detailsHtml}
                `;
                
                container.className = 'result-container result-success';
                container.style.display = 'block';
            }

            showError(message, result = null) {
                const container = document.getElementById('result-container');
                const content = document.getElementById('result-content');
                
                let detailsHtml = '';
                if (result && result.verification_result) {
                    const vr = result.verification_result;
                    detailsHtml = `
                        <div style="margin-top: 15px; font-size: 0.9em;">
                            <strong>Response Details:</strong><br>
                            ${vr.response_code ? `Code: ${vr.response_code}<br>` : ''}
                            ${vr.response_message ? `Message: ${vr.response_message}<br>` : ''}
                            ${vr.transaction_id ? `Transaction ID: ${vr.transaction_id}` : ''}
                        </div>
                    `;
                }

                content.innerHTML = `
                    <div class="result error">
                        <div class="result-header">
                            <span class="result-icon">âŒ</span>
                            <span class="result-title">Verification Failed</span>
                        </div>
                        <div class="result-message">${message}</div>
                        ${detailsHtml}
                    </div>
                `;
                
                container.style.display = 'block';
            }

            showHppIframe(iframeUrl, paymentData) {
                // Hide payment form and show iframe container
                const paymentForm = document.getElementById('payment-form');
                const container = document.getElementById('result-container');
                const content = document.getElementById('result-content');
                
                paymentForm.style.display = 'none';
                
                content.innerHTML = `
                    <div class="hpp-container">
                        <div class="hpp-header">
                            <h3>ğŸ”’ Secure Payment</h3>
                            <p>Complete your payment of $${paymentData.amount} ${paymentData.currency}</p>
                            <button type="button" id="close-hpp" class="close-button">âœ• Close</button>
                        </div>
                        <div class="hpp-iframe-wrapper">
                            <iframe 
                                id="hpp-iframe" 
                                src="${iframeUrl}" 
                                width="100%" 
                                height="600"
                                frameborder="0"
                                scrolling="auto"
                                sandbox="allow-forms allow-scripts allow-same-origin allow-top-navigation"
                                title="Global Payments Hosted Payment Page">
                            </iframe>
                        </div>
                        <div class="hpp-footer">
                            <p>ğŸ”’ Your payment is processed securely by Global Payments</p>
                        </div>
                    </div>
                `;
                
                container.style.display = 'block';
                
                // Add close button functionality
                document.getElementById('close-hpp').addEventListener('click', () => {
                    this.closeHppIframe();
                });
                
                // Listen for messages from the iframe (payment completion)
                this.setupIframeListeners();
            }

            closeHppIframe() {
                const paymentForm = document.getElementById('payment-form');
                const container = document.getElementById('result-container');
                
                container.style.display = 'none';
                paymentForm.style.display = 'block';
            }

            setupIframeListeners() {
                // Listen for postMessage events from the HPP iframe
                window.addEventListener('message', (event) => {
                    // Verify origin for security (adjust based on your Global Payments environment)
                    const allowedOrigins = [
                        'https://apis.sandbox.globalpay.com',
                        'https://hpp.sandbox.globalpay.com',
                        'https://apis.globalpay.com',
                        'https://hpp.globalpay.com'
                    ];
                    
                    if (!allowedOrigins.includes(event.origin)) {
                        return;
                    }
                    
                    // Handle payment completion messages
                    if (event.data && event.data.type === 'payment_complete') {
                        this.handlePaymentComplete(event.data);
                    }
                }, { once: true });
            }

            handlePaymentComplete(paymentResult) {
                // Close the iframe
                this.closeHppIframe();
                
                // Show payment result
                if (paymentResult.status === 'success' || paymentResult.status === 'approved') {
                    this.showPaymentSuccess(paymentResult);
                } else {
                    this.showPaymentError(paymentResult);
                }
            }

            showPaymentSuccess(result) {
                const container = document.getElementById('result-container');
                const content = document.getElementById('result-content');
                
                content.innerHTML = `
                    <div class="result success">
                        <div class="result-header">
                            <span class="result-icon">âœ…</span>
                            <span class="result-title">Payment Successful</span>
                        </div>
                        <div class="result-message">Your payment has been processed successfully!</div>
                        <div style="margin-top: 15px; font-size: 0.9em;">
                            <strong>Payment Details:</strong><br>
                            ${result.transaction_id ? `Transaction ID: ${result.transaction_id}<br>` : ''}
                            ${result.amount ? `Amount: $${result.amount} ${result.currency || 'USD'}<br>` : ''}
                            ${result.reference ? `Reference: ${result.reference}<br>` : ''}
                            ${result.payment_method ? `Payment Method: ${result.payment_method}` : ''}
                        </div>
                    </div>
                `;
                
                container.style.display = 'block';
            }

            showPaymentError(result) {
                const container = document.getElementById('result-container');
                const content = document.getElementById('result-content');
                
                content.innerHTML = `
                    <div class="result error">
                        <div class="result-header">
                            <span class="result-icon">âŒ</span>
                            <span class="result-title">Payment Failed</span>
                        </div>
                        <div class="result-message">${result.message || 'Payment could not be processed'}</div>
                        <div style="margin-top: 15px; font-size: 0.9em;">
                            <strong>Error Details:</strong><br>
                            ${result.error_code ? `Code: ${result.error_code}<br>` : ''}
                            ${result.transaction_id ? `Transaction ID: ${result.transaction_id}` : ''}
                        </div>
                    </div>
                `;
                
                container.style.display = 'block';
            }

            hideResult() {
                document.getElementById('result-container').style.display = 'none';
            }

            /**
             * Update address field labels and placeholders based on selected country
             * @param {string} countryCode - The selected country code (e.g., 'US', 'GB', 'CA')
             */
            updateAddressFields(countryCode) {
                const streetLabel = document.getElementById('street-label');
                const cityLabel = document.getElementById('city-label');
                const stateLabel = document.getElementById('state-label');
                const postalLabel = document.getElementById('postal-label');
                
                const streetField = document.getElementById('payment-billing-street');
                const cityField = document.getElementById('payment-billing-city');
                const stateField = document.getElementById('payment-billing-state');
                const postalField = document.getElementById('payment-billing-postal');

                // Country-specific address format configurations
                const addressFormats = {
                    'US': {
                        street: { label: 'Street Address', placeholder: '123 Main St' },
                        city: { label: 'City', placeholder: 'New York' },
                        state: { label: 'State', placeholder: 'NY' },
                        postal: { label: 'ZIP Code', placeholder: '12345' }
                    },
                    'CA': {
                        street: { label: 'Street Address', placeholder: '123 Main St' },
                        city: { label: 'City', placeholder: 'Toronto' },
                        state: { label: 'Province', placeholder: 'ON' },
                        postal: { label: 'Postal Code', placeholder: 'K1A 0A6' }
                    },
                    'GB': {
                        street: { label: 'Address Line 1', placeholder: '123 High Street' },
                        city: { label: 'Town/City', placeholder: 'London' },
                        state: { label: 'County', placeholder: 'Greater London' },
                        postal: { label: 'Postcode', placeholder: 'SW1A 1AA' }
                    },
                    'IE': {
                        street: { label: 'Address Line 1', placeholder: '123 Grafton Street' },
                        city: { label: 'Town/City', placeholder: 'Dublin' },
                        state: { label: 'County', placeholder: 'Dublin' },
                        postal: { label: 'Eircode', placeholder: 'D02 XY45' }
                    },
                    'AU': {
                        street: { label: 'Street Address', placeholder: '123 Collins Street' },
                        city: { label: 'Suburb', placeholder: 'Melbourne' },
                        state: { label: 'State', placeholder: 'VIC' },
                        postal: { label: 'Postcode', placeholder: '3000' }
                    },
                    'NZ': {
                        street: { label: 'Street Address', placeholder: '123 Queen Street' },
                        city: { label: 'Suburb', placeholder: 'Auckland' },
                        state: { label: 'Region', placeholder: 'Auckland' },
                        postal: { label: 'Postcode', placeholder: '1010' }
                    },
                    'ZA': {
                        street: { label: 'Street Address', placeholder: '123 Long Street' },
                        city: { label: 'City', placeholder: 'Cape Town' },
                        state: { label: 'Province', placeholder: 'Western Cape' },
                        postal: { label: 'Postal Code', placeholder: '8001' }
                    },
                    'DE': {
                        street: { label: 'StraÃŸe und Hausnummer', placeholder: 'MusterstraÃŸe 123' },
                        city: { label: 'Stadt', placeholder: 'Berlin' },
                        state: { label: 'Bundesland', placeholder: 'Berlin' },
                        postal: { label: 'Postleitzahl', placeholder: '10115' }
                    },
                    'FR': {
                        street: { label: 'Adresse', placeholder: '123 Rue de la Paix' },
                        city: { label: 'Ville', placeholder: 'Paris' },
                        state: { label: 'RÃ©gion', placeholder: 'Ãle-de-France' },
                        postal: { label: 'Code postal', placeholder: '75001' }
                    },
                    'IT': {
                        street: { label: 'Indirizzo', placeholder: 'Via Roma 123' },
                        city: { label: 'CittÃ ', placeholder: 'Roma' },
                        state: { label: 'Provincia', placeholder: 'RM' },
                        postal: { label: 'CAP', placeholder: '00100' }
                    },
                    'ES': {
                        street: { label: 'DirecciÃ³n', placeholder: 'Calle Mayor 123' },
                        city: { label: 'Ciudad', placeholder: 'Madrid' },
                        state: { label: 'Provincia', placeholder: 'Madrid' },
                        postal: { label: 'CÃ³digo postal', placeholder: '28001' }
                    },
                    'NL': {
                        street: { label: 'Adres', placeholder: 'Hoofdstraat 123' },
                        city: { label: 'Plaats', placeholder: 'Amsterdam' },
                        state: { label: 'Provincie', placeholder: 'Noord-Holland' },
                        postal: { label: 'Postcode', placeholder: '1012 AB' }
                    },
                    'CH': {
                        street: { label: 'Adresse', placeholder: 'Bahnhofstrasse 123' },
                        city: { label: 'Stadt', placeholder: 'ZÃ¼rich' },
                        state: { label: 'Kanton', placeholder: 'ZH' },
                        postal: { label: 'PLZ', placeholder: '8001' }
                    },
                    'AT': {
                        street: { label: 'Adresse', placeholder: 'RingstraÃŸe 123' },
                        city: { label: 'Stadt', placeholder: 'Wien' },
                        state: { label: 'Bundesland', placeholder: 'Wien' },
                        postal: { label: 'PLZ', placeholder: '1010' }
                    },
                    'BE': {
                        street: { label: 'Adresse/Adres', placeholder: 'Rue de la Loi 123' },
                        city: { label: 'Ville/Stad', placeholder: 'Brussels' },
                        state: { label: 'Province/Provincie', placeholder: 'Brussels' },
                        postal: { label: 'Code postal', placeholder: '1000' }
                    },
                    'SE': {
                        street: { label: 'Gatuadress', placeholder: 'Drottninggatan 123' },
                        city: { label: 'Stad', placeholder: 'Stockholm' },
                        state: { label: 'LÃ¤n', placeholder: 'Stockholm' },
                        postal: { label: 'Postnummer', placeholder: '11151' }
                    },
                    'NO': {
                        street: { label: 'Gateadresse', placeholder: 'Karl Johans gate 123' },
                        city: { label: 'Poststed', placeholder: 'Oslo' },
                        state: { label: 'Fylke', placeholder: 'Oslo' },
                        postal: { label: 'Postnummer', placeholder: '0154' }
                    },
                    'DK': {
                        street: { label: 'Adresse', placeholder: 'StrÃ¸get 123' },
                        city: { label: 'By', placeholder: 'KÃ¸benhavn' },
                        state: { label: 'Region', placeholder: 'Hovedstaden' },
                        postal: { label: 'Postnummer', placeholder: '1000' }
                    },
                    'FI': {
                        street: { label: 'Katuosoite', placeholder: 'Mannerheimintie 123' },
                        city: { label: 'Kaupunki', placeholder: 'Helsinki' },
                        state: { label: 'Maakunta', placeholder: 'Uusimaa' },
                        postal: { label: 'Postinumero', placeholder: '00100' }
                    },
                    'JP': {
                        street: { label: 'ä½æ‰€', placeholder: 'æ±äº¬éƒ½æ¸‹è°·åŒº1-2-3' },
                        city: { label: 'å¸‚åŒºç”ºæ‘', placeholder: 'æ¸‹è°·åŒº' },
                        state: { label: 'éƒ½é“åºœçœŒ', placeholder: 'æ±äº¬éƒ½' },
                        postal: { label: 'éƒµä¾¿ç•ªå·', placeholder: '150-0001' }
                    },
                    'CN': {
                        street: { label: 'è¡—é“åœ°å€', placeholder: 'å—äº¬è·¯123å·' },
                        city: { label: 'åŸå¸‚', placeholder: 'ä¸Šæµ·' },
                        state: { label: 'çœ/ç›´è¾–å¸‚', placeholder: 'ä¸Šæµ·å¸‚' },
                        postal: { label: 'é‚®æ”¿ç¼–ç ', placeholder: '200001' }
                    },
                    'KR': {
                        street: { label: 'ë„ë¡œëª…ì£¼ì†Œ', placeholder: 'ê°•ë‚¨ëŒ€ë¡œ 123' },
                        city: { label: 'ì‹œ/êµ°/êµ¬', placeholder: 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬' },
                        state: { label: 'ì‹œ/ë„', placeholder: 'ì„œìš¸íŠ¹ë³„ì‹œ' },
                        postal: { label: 'ìš°í¸ë²ˆí˜¸', placeholder: '06292' }
                    },
                    'IN': {
                        street: { label: 'Address Line 1', placeholder: '123 MG Road' },
                        city: { label: 'City', placeholder: 'Mumbai' },
                        state: { label: 'State', placeholder: 'Maharashtra' },
                        postal: { label: 'PIN Code', placeholder: '400001' }
                    },
                    'SG': {
                        street: { label: 'Block/Street', placeholder: '123 Orchard Road' },
                        city: { label: 'City', placeholder: 'Singapore' },
                        state: { label: 'District', placeholder: 'Central' },
                        postal: { label: 'Postal Code', placeholder: '238874' }
                    },
                    'HK': {
                        street: { label: 'Address Line 1', placeholder: '123 Nathan Road' },
                        city: { label: 'District', placeholder: 'Tsim Sha Tsui' },
                        state: { label: 'Region', placeholder: 'Kowloon' },
                        postal: { label: 'Postal Code', placeholder: '' }
                    },
                    'TW': {
                        street: { label: 'åœ°å€', placeholder: 'ä¸­å±±è·¯123è™Ÿ' },
                        city: { label: 'å¸‚/ç¸£', placeholder: 'å°åŒ—å¸‚' },
                        state: { label: 'ç¸£å¸‚', placeholder: 'å°åŒ—å¸‚' },
                        postal: { label: 'éƒµéå€è™Ÿ', placeholder: '100' }
                    },
                    'BR': {
                        street: { label: 'EndereÃ§o', placeholder: 'Rua das Flores, 123' },
                        city: { label: 'Cidade', placeholder: 'SÃ£o Paulo' },
                        state: { label: 'Estado', placeholder: 'SP' },
                        postal: { label: 'CEP', placeholder: '01234-567' }
                    },
                    'MX': {
                        street: { label: 'DirecciÃ³n', placeholder: 'Calle Principal 123' },
                        city: { label: 'Ciudad', placeholder: 'Ciudad de MÃ©xico' },
                        state: { label: 'Estado', placeholder: 'CDMX' },
                        postal: { label: 'CÃ³digo postal', placeholder: '06000' }
                    },
                    'AR': {
                        street: { label: 'DirecciÃ³n', placeholder: 'Av. Corrientes 123' },
                        city: { label: 'Ciudad', placeholder: 'Buenos Aires' },
                        state: { label: 'Provincia', placeholder: 'CABA' },
                        postal: { label: 'CÃ³digo postal', placeholder: 'C1043' }
                    },
                    'CL': {
                        street: { label: 'DirecciÃ³n', placeholder: 'Av. Providencia 123' },
                        city: { label: 'Ciudad', placeholder: 'Santiago' },
                        state: { label: 'RegiÃ³n', placeholder: 'Metropolitana' },
                        postal: { label: 'CÃ³digo postal', placeholder: '7500000' }
                    },
                    'CO': {
                        street: { label: 'DirecciÃ³n', placeholder: 'Carrera 7 # 123-45' },
                        city: { label: 'Ciudad', placeholder: 'BogotÃ¡' },
                        state: { label: 'Departamento', placeholder: 'Cundinamarca' },
                        postal: { label: 'CÃ³digo postal', placeholder: '110111' }
                    },
                    'PE': {
                        street: { label: 'DirecciÃ³n', placeholder: 'Av. Arequipa 123' },
                        city: { label: 'Ciudad', placeholder: 'Lima' },
                        state: { label: 'RegiÃ³n', placeholder: 'Lima' },
                        postal: { label: 'CÃ³digo postal', placeholder: '15001' }
                    },
                    'RU': {
                        street: { label: 'ĞĞ´Ñ€ĞµÑ', placeholder: 'ÑƒĞ». Ğ¢Ğ²ĞµÑ€ÑĞºĞ°Ñ, 123' },
                        city: { label: 'Ğ“Ğ¾Ñ€Ğ¾Ğ´', placeholder: 'ĞœĞ¾ÑĞºĞ²Ğ°' },
                        state: { label: 'Ğ ĞµĞ³Ğ¸Ğ¾Ğ½', placeholder: 'ĞœĞ¾ÑĞºĞ²Ğ°' },
                        postal: { label: 'ĞŸĞ¾Ñ‡Ñ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ¸Ğ½Ğ´ĞµĞºÑ', placeholder: '125009' }
                    },
                    'TR': {
                        street: { label: 'Adres', placeholder: 'Ä°stiklal Caddesi 123' },
                        city: { label: 'Åehir', placeholder: 'Ä°stanbul' },
                        state: { label: 'Ä°l', placeholder: 'Ä°stanbul' },
                        postal: { label: 'Posta Kodu', placeholder: '34000' }
                    },
                    'PL': {
                        street: { label: 'Adres', placeholder: 'ul. MarszaÅ‚kowska 123' },
                        city: { label: 'Miasto', placeholder: 'Warszawa' },
                        state: { label: 'WojewÃ³dztwo', placeholder: 'Mazowieckie' },
                        postal: { label: 'Kod pocztowy', placeholder: '00-001' }
                    },
                    'CZ': {
                        street: { label: 'Adresa', placeholder: 'VÃ¡clavskÃ© nÃ¡mÄ›stÃ­ 123' },
                        city: { label: 'MÄ›sto', placeholder: 'Praha' },
                        state: { label: 'Kraj', placeholder: 'Praha' },
                        postal: { label: 'PSÄŒ', placeholder: '110 00' }
                    },
                    'HU': {
                        street: { label: 'CÃ­m', placeholder: 'VÃ¡ci utca 123' },
                        city: { label: 'VÃ¡ros', placeholder: 'Budapest' },
                        state: { label: 'Megye', placeholder: 'Budapest' },
                        postal: { label: 'IrÃ¡nyÃ­tÃ³szÃ¡m', placeholder: '1052' }
                    },
                    'PT': {
                        street: { label: 'Morada', placeholder: 'Rua Augusta 123' },
                        city: { label: 'Cidade', placeholder: 'Lisboa' },
                        state: { label: 'Distrito', placeholder: 'Lisboa' },
                        postal: { label: 'CÃ³digo postal', placeholder: '1100-048' }
                    },
                    'GR': {
                        street: { label: 'Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·', placeholder: 'Î•ÏÎ¼Î¿Ï 123' },
                        city: { label: 'Î ÏŒÎ»Î·', placeholder: 'Î‘Î¸Î®Î½Î±' },
                        state: { label: 'Î ÎµÏÎ¹Ï†Î­ÏÎµÎ¹Î±', placeholder: 'Î‘Ï„Ï„Î¹ÎºÎ®' },
                        postal: { label: 'Î¤Î±Ï‡Ï…Î´ÏÎ¿Î¼Î¹ÎºÏŒÏ‚ ÎºÏÎ´Î¹ÎºÎ±Ï‚', placeholder: '10563' }
                    }
                };

                // Default format (fallback)
                const defaultFormat = {
                    street: { label: 'Street Address', placeholder: '123 Main St' },
                    city: { label: 'City', placeholder: 'City' },
                    state: { label: 'State/Province', placeholder: 'State' },
                    postal: { label: 'Postal Code', placeholder: '12345' }
                };

                // Get format for selected country or use default
                const format = addressFormats[countryCode] || defaultFormat;

                // Update labels and placeholders with smooth transition
                if (streetLabel && streetField) {
                    streetLabel.textContent = format.street.label;
                    streetField.placeholder = format.street.placeholder;
                }
                
                if (cityLabel && cityField) {
                    cityLabel.textContent = format.city.label;
                    cityField.placeholder = format.city.placeholder;
                }
                
                if (stateLabel && stateField) {
                    stateLabel.textContent = format.state.label;
                    stateField.placeholder = format.state.placeholder;
                }
                
                if (postalLabel && postalField) {
                    postalLabel.textContent = format.postal.label;
                    postalField.placeholder = format.postal.placeholder;
                }

                // Add visual feedback for country change
                const addressFields = [streetField, cityField, stateField, postalField];
                addressFields.forEach(field => {
                    if (field) {
                        field.classList.add('country-updated');
                        setTimeout(() => field.classList.remove('country-updated'), 300);
                    }
                });

                console.log(`ğŸ“ Address format updated for country: ${countryCode}`);
            }
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            new CardAuthenticator();
        });
    </script>
</body>
</html>